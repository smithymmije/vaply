<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title><%- locals.title %></title>
  <meta name="description" content="<%- locals.description %>" />
  <meta name="author" content="Jimmy Smith" />

  <!-- Fontes Google -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Unbounded:wght@400..800&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Font Awesome v6.5.0 -->
  <link href="https://use.fontawesome.com/releases/v6.5.0/css/all.css" rel="stylesheet" />

  <!-- CSS personalizado -->
  <link rel="stylesheet" href="/css/main.css" />

  <% if (typeof vaga !== 'undefined') { 
    let descriptionClean = '';
    if (vaga.jobDescription) {
      descriptionClean = vaga.jobDescription
        .replace(/"/g, '\\"')
        .replace(/(<([^>]+)>)/gi, '')
        .replace(/(\r\n|\n|\r)/gm, ' ')
        .trim();
    }
%>
<script type="application/ld+json">
{
  "@context": "https://schema.org/",
  "@type": "JobPosting",
  "title": "<%= vaga.jobTitle %>",
  "description": "<%= descriptionClean %>",
  "datePosted": "<%= vaga.createdAt.toISOString() %>",
  "validThrough": "<%= new Date(new Date(vaga.createdAt).getTime() + 30*24*60*60*1000).toISOString() %>",
  "employmentType": "<%= vaga.jobType || 'FULL_TIME' %>",
  "hiringOrganization": {
    "@type": "Organization",
    "name": "<%= vaga.companyName %>",
    <% if (vaga.companyUrl) { %>
    "sameAs": "<%= vaga.companyUrl %>",
    <% } %>
    "logo": "<%= vaga.companyLogo || '/images/default-company-logo.png' %>"
  },
  "jobLocation": {
    "@type": "Place",
    "address": {
      "@type": "PostalAddress",
      "addressLocality": "<%= vaga.location || 'Espírito Santo' %>",
      "addressRegion": "ES",
      "addressCountry": "BR"
      <% if (vaga.streetAddress) { %>,
      "streetAddress": "<%= vaga.streetAddress %>"
      <% } %>
    }
  }
  <% if (vaga.salaryMin && vaga.salaryMax) { %>,
  "baseSalary": {
    "@type": "MonetaryAmount",
    "currency": "BRL",
    "value": {
      "@type": "QuantitativeValue",
      "minValue": <%= vaga.salaryMin %>,
      "maxValue": <%= vaga.salaryMax %>,
      "unitText": "MONTH"
    }
  }
  <% } %>
  <% if (vaga.experienceRequirements) { %>,
  "experienceRequirements": "<%= vaga.experienceRequirements %>"
  <% } %>
  <% if (vaga.educationRequirements) { %>,
  "educationRequirements": "<%= vaga.educationRequirements %>"
  <% } %>
  <% if (vaga.jobBenefits) { %>,
  "jobBenefits": "<%= vaga.jobBenefits %>"
  <% } %>
  <% if (vaga.workHours) { %>,
  "workHours": "<%= vaga.workHours %>"
  <% } %>
}
</script>
<% } %>



</head>
<body class="home">
  <%- include('../partials/header.ejs') %>
  <%- body %>
  <%- include('../partials/footer.ejs') %>

  <script src="/js/scrollNotas.js"></script>
<script src="/js/cookies.js"></script>
<script src="/js/util.js"></script>

<div id="cookieOverlay"></div>

<div id="cookieBanner" role="alert">
  <div class="cookie-text">
    <strong>Este site utiliza cookies</strong>
    Usamos tecnologias como cookies para melhorar sua experiência, personalizar conteúdo e anúncios, e analisar nosso tráfego. Compartilhamos informações com nossos parceiros de publicidade e análise.
    Você pode aceitar todos os cookies ou escolher quais permitir.
    Para saber mais, veja nosso <a href="privacidade.html">Aviso de Privacidade</a>.
  </div>
  <div class="cookie-buttons">
    <button class="btn-customize" id="btnPersonalizarCookies">Personalizar</button>
    <button class="btn-accept" id="btnAceitarTudo">Aceitar Tudo</button>
  </div>
</div>

<div id="cookieModal" style="display:none;">
  <div class="cookieModalContent">
    <h2>Preferências de Cookies</h2>
    <form id="cookieForm">
      <label>
        <input type="checkbox" name="necessary" checked disabled>
        Cookies necessários (obrigatórios)
      </label><br><br>

      <label>
        <input type="checkbox" name="analytics" id="analytics">
        Cookies de análise (Google Analytics)
      </label><br><br>

      <label>
        <input type="checkbox" name="marketing" id="marketing">
        Cookies de marketing (Facebook Pixel)
      </label><br><br>

      <button type="submit" id="btnSalvarPreferencias">Salvar preferências</button>
      <button type="button" id="btnCancelarModal">Cancelar</button>
    </form>
  </div>
</div>

<script>
  function isInWebView() {
    const userAgent = navigator.userAgent || navigator.vendor || window.opera;
    return (
      userAgent.includes("FBAN") || // Facebook
      userAgent.includes("FBAV") ||
      userAgent.includes("Instagram") ||
      userAgent.includes("LinkedIn") ||
      (userAgent.includes("wv") && /Android/i.test(userAgent)) // Android WebView
    );
  }

  if (isInWebView()) {
    const loginBtn = document.getElementById("google-login-btn");
    if (loginBtn) loginBtn.style.display = "none";

    const warning = document.createElement("div");
    warning.style.background = "#ffe9e9";
    warning.style.color = "#b30000";
    warning.style.padding = "1rem";
    warning.style.border = "1px solid #ff0000";
    warning.style.borderRadius = "8px";
    warning.style.margin = "2rem";
    warning.style.textAlign = "center";

    warning.innerHTML = `
      ⚠️ O login com Google não funciona neste ambiente.<br>
      <strong>Toque no botão abaixo para abrir no navegador:</strong><br><br>
      <a href="${window.location.href}" style="
        display: inline-block;
        padding: 10px 20px;
        background-color: #b30000;
        color: white;
        border-radius: 6px;
        text-decoration: none;
        font-weight: bold;
      ">Abrir no navegador</a>
    `;
    document.body.prepend(warning);
  }
</script>


</body>
</html>
