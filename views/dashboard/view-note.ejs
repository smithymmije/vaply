<div class="add-note-wrapper">
  <nav class="breadcrumb-nav">
    <ul class="breadcrumb-list">
      <li><a href="/dashboard">Painel</a></li>
      <li><%= job.jobTitle %></li>
    </ul>
  </nav>

  <div class="note-header">
    <h1 class="title-view">Ver/Editar Vaga</h1>
    <button type="button" class="btn-danger" id="deleteButton">Excluir</button>
  </div>

  <form action="/dashboard/job/<%= job._id %>?_method=PUT" method="POST" class="note-form">

    <div class="form-group">
      <label for="jobTitle">Título da Vaga</label>
      <input type="text" id="jobTitle" name="jobTitle" class="form-input" value="<%= job.jobTitle %>" required placeholder="Ex: Analista Fiscal Júnior">
    </div>

    <div class="form-group">
      <label for="location">Local de trabalho</label>
      <input type="text" id="location" name="location" class="form-input" value="<%= job.location %>" required placeholder="Ex: Vila Velha – ES">
    </div>

    <div class="form-group">
      <label for="companyName">Nome da Empresa (opcional)</label>
      <input type="text" id="companyName" name="companyName" class="form-input" value="<%= job.companyName %>" placeholder="Ex: Confidencial">
    </div>

    <div class="form-group">
      <label for="contractType">Tipo de Contrato</label>
      <select id="contractType" name="contractType" class="form-input" required>
        <option value="">Selecione uma opção</option>
        <option value="CLT" <%= job.contractType === 'CLT' ? 'selected' : '' %>>CLT</option>
        <option value="PJ" <%= job.contractType === 'PJ' ? 'selected' : '' %>>PJ</option>
        <option value="Estágio" <%= job.contractType === 'Estágio' ? 'selected' : '' %>>Estágio</option>
        <option value="Temporário" <%= job.contractType === 'Temporário' ? 'selected' : '' %>>Temporário</option>
        <option value="Freelancer" <%= job.contractType === 'Freelancer' ? 'selected' : '' %>>Freelancer</option>
        <option value="Outros" <%= job.contractType === 'Outros' ? 'selected' : '' %>>Outros</option>
      </select>
    </div>

    <div class="form-group">
      <label for="workSchedule">Jornada de Trabalho</label>
      <select id="workSchedule" name="workSchedule" class="form-input" required>
        <option value="">Selecione uma opção</option>
        <option value="Integral" <%= job.workSchedule === 'Integral' ? 'selected' : '' %>>Integral</option>
        <option value="Meio período" <%= job.workSchedule === 'Meio período' ? 'selected' : '' %>>Meio período</option>
        <option value="Escala" <%= job.workSchedule === 'Escala' ? 'selected' : '' %>>Escala (especifique abaixo)</option>
        <option value="Híbrido" <%= job.workSchedule === 'Híbrido' ? 'selected' : '' %>>Híbrido</option>
        <option value="Remoto" <%= job.workSchedule === 'Remoto' ? 'selected' : '' %>>Remoto</option>
        <option value="Outros" <%= job.workSchedule === 'Outros' ? 'selected' : '' %>>Outros</option>
      </select>
      <input type="text" name="workScheduleDetails" class="form-input" value="<%= job.workScheduleDetails || '' %>" placeholder="Detalhes da escala ou outros formatos">
    </div>

    <div class="form-group">
      <label for="mission">Missão / Objetivo do Cargo</label>
      <textarea id="mission" name="mission" class="form-input" rows="2"><%= job.mission || '' %></textarea>
    </div>

    <div class="form-group">
      <label for="responsibilities">Principais Atribuições / Responsabilidades</label>
      <textarea id="responsibilities" name="responsibilities" class="form-input" rows="4" required><%= job.responsibilities %></textarea>
    </div>

    <div class="form-group">
      <label>Requisitos Obrigatórios</label>
      <input type="text" name="education" class="form-input" value="<%= job.education || '' %>" placeholder="Formação">
      <input type="text" name="experience" class="form-input" value="<%= job.experience || '' %>" placeholder="Experiência mínima">
      <input type="text" name="technicalSkills" class="form-input" value="<%= job.technicalSkills || '' %>" placeholder="Conhecimentos técnicos">
    </div>

    <div class="form-group">
      <label for="desiredSkills">Requisitos Desejáveis</label>
      <textarea id="desiredSkills" name="desiredSkills" class="form-input" rows="2"><%= job.desiredSkills || '' %></textarea>
    </div>

    <div class="form-group">
      <label for="differentials">Diferenciais</label>
      <textarea id="differentials" name="differentials" class="form-input" rows="2" placeholder="Ex: idiomas, certificações, conhecimento em startups..."><%= job.differentials || '' %></textarea>
    </div>

    <div class="form-group">
      <label for="salaryRange">Faixa Salarial</label>
      <input type="text" id="salaryRange" name="salaryRange" class="form-input" value="<%= job.salaryRange || '' %>" placeholder="Ex: R$2.000 a R$2.500">
    </div>

    <div class="form-group">
      <label for="benefitsText">Benefícios Oferecidos</label>
      <textarea id="benefitsText" name="benefitsText" class="form-input" rows="4"
        placeholder="Liste aqui todos os benefícios da vaga, como: Vale alimentação/refeição (valor), Vale transporte, Plano de saúde, Plano odontológico, Bonificações, Licença estendida, etc."><%= job.benefitsText || '' %></textarea>
    </div>

    <div class="form-group">
      <label for="applicationEmail">E-mail para candidatura</label>
      <input type="email" id="applicationEmail" name="applicationEmail" class="form-input" value="<%= job.applicationEmail || '' %>" placeholder="Ex: recrutamento@empresa.com">
    </div>

    <div class="form-group">
      <label for="applicationLink">Link ou QR Code</label>
      <input type="url" id="applicationLink" name="applicationLink" class="form-input" value="<%= job.applicationLink || '' %>">
    </div>

    <div class="form-group">
      <label for="applicationSite">Site de candidatura</label>
      <input type="url" id="applicationSite" name="applicationSite" class="form-input" value="<%= job.applicationSite || '' %>">
    </div>

    <div class="form-group">
      <label for="submissionInstructions">Instruções para envio</label>
      <textarea id="submissionInstructions" name="submissionInstructions" class="form-input" rows="2" placeholder="Ex: Assunto do e-mail “Vaga – Cidade – Nome”"><%= job.submissionInstructions || '' %></textarea>
    </div>

    <div class="form-group">
      <label for="deadline">Prazo para envio</label>
      <input type="text" id="deadline" name="deadline" class="form-input" value="<%= job.deadline || '' %>" placeholder="Ex: Até 31/07/2025">
    </div>

    <div class="form-group">
      <label for="institutionalMessage">Mensagem Institucional</label>
      <textarea id="institutionalMessage" name="institutionalMessage" class="form-input" rows="2" placeholder="Ex: Venha crescer com a gente!"><%= job.institutionalMessage || '' %></textarea>
    </div>

    

    <button type="submit" class="btn-primary">Atualizar Vaga</button>
  </form>

  <div class="modal" id="deleteModal" style="display: none;">
    <div class="modal-box">
      <div class="modal-header">
        <h2>Excluir vaga?</h2>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <p>Isso excluirá permanentemente a vaga <strong><%= job.jobTitle %></strong>. Tem certeza?</p>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" onclick="closeModal()">Cancelar</button>
        <form action="/dashboard/job-delete/<%= job._id %>?_method=DELETE" method="POST" style="display:inline;">
          <button type="submit" class="btn-primary">Deletar Vaga</button>
        </form>
      </div>
    </div>
  </div>

  <script>
    const deleteButton = document.getElementById('deleteButton');
    const deleteModal = document.getElementById('deleteModal');

    deleteButton.addEventListener('click', () => {
      deleteModal.style.display = 'flex';
    });

    function closeModal() {
      deleteModal.style.display = 'none';
    }
  </script>
</div>